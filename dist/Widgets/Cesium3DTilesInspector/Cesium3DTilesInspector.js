import Check from"../../Core/Check.js";import defaultValue from"../../Core/defaultValue.js";import defined from"../../Core/defined.js";import destroyObject from"../../Core/destroyObject.js";import knockout from"../../ThirdParty/knockout.js";import getElement from"../getElement.js";import InspectorShared from"../InspectorShared.js";import Cesium3DTilesInspectorViewModel from"./Cesium3DTilesInspectorViewModel.js";function Cesium3DTilesInspector(e,t){Check.defined("container",e),Check.typeOf.object("scene",t),e=getElement(e);const i=document.createElement("div"),n=document.createElement("div");n.setAttribute("data-bind","visible: performance");const s=new Cesium3DTilesInspectorViewModel(t,n);this._viewModel=s,this._container=e,this._element=i;const a=document.createElement("div");a.textContent="3D Tiles Inspector",a.className="cesium-cesiumInspector-button",a.setAttribute("data-bind","click: toggleInspector"),i.appendChild(a),i.className="cesium-cesiumInspector cesium-3DTilesInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(i);const o=document.createElement("div");this._panel=o,o.className="cesium-cesiumInspector-dropDown",i.appendChild(o);const d=InspectorShared.createSection,c=InspectorShared.createCheckbox,r=d(o,"Tileset","tilesetVisible","toggleTileset"),l=d(o,"Display","displayVisible","toggleDisplay"),p=d(o,"Update","updateVisible","toggleUpdate"),m=d(o,"Logging","loggingVisible","toggleLogging"),u=d(o,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),h=d(o,"Style","styleVisible","toggleStyle"),C=d(o,"Optimization","optimizationVisible","toggleOptimization"),g=document.createElement("div");g.className="field-group";const b=document.createElement("label");b.className="field-label",b.appendChild(document.createTextNode("Properties: "));const S=document.createElement("div");S.setAttribute("data-bind","text: properties"),g.appendChild(b),g.appendChild(S),r.appendChild(g),r.appendChild(makeButton("togglePickTileset","Pick Tileset","pickActive")),r.appendChild(makeButton("trimTilesCache","Trim Tiles Cache")),r.appendChild(c("Enable Picking","picking")),l.appendChild(c("Colorize","colorize")),l.appendChild(c("Wireframe","wireframe")),l.appendChild(c("Bounding Volumes","showBoundingVolumes")),l.appendChild(c("Content Volumes","showContentBoundingVolumes")),l.appendChild(c("Request Volumes","showRequestVolumes")),l.appendChild(c("Point Cloud Shading","pointCloudShading"));const E=document.createElement("div");E.setAttribute("data-bind","visible: pointCloudShading"),E.appendChild(makeRangeInput("geometricErrorScale",0,2,.01,"Geometric Error Scale")),E.appendChild(makeRangeInput("maximumAttenuation",0,32,1,"Maximum Attenuation")),E.appendChild(makeRangeInput("baseResolution",0,1,.01,"Base Resolution")),E.appendChild(c("Eye Dome Lighting (EDL)","eyeDomeLighting")),l.appendChild(E);const k=document.createElement("div");k.setAttribute("data-bind","visible: eyeDomeLighting"),k.appendChild(makeRangeInput("eyeDomeLightingStrength",0,2,.1,"EDL Strength")),k.appendChild(makeRangeInput("eyeDomeLightingRadius",0,4,.1,"EDL Radius")),E.appendChild(k),p.appendChild(c("Freeze Frame","freezeFrame")),p.appendChild(c("Dynamic Screen Space Error","dynamicScreenSpaceError"));const y=document.createElement("div");y.appendChild(makeRangeInput("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error")),p.appendChild(y);const v=document.createElement("div");v.setAttribute("data-bind","visible: dynamicScreenSpaceError"),v.appendChild(makeRangeInput("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity")),v.appendChild(makeRangeInput("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor")),p.appendChild(v),m.appendChild(c("Performance","performance")),m.appendChild(n),m.appendChild(c("Statistics","showStatistics"));const I=document.createElement("div");I.className="cesium-3dTilesInspector-statistics",I.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),m.appendChild(I),m.appendChild(c("Pick Statistics","showPickStatistics"));const f=document.createElement("div");f.className="cesium-3dTilesInspector-statistics",f.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),m.appendChild(f),m.appendChild(c("Resource Cache Statistics","showResourceCacheStatistics"));const D=document.createElement("div");D.className="cesium-3dTilesInspector-statistics",D.setAttribute("data-bind","html: resourceCacheStatisticsText, visible: showResourceCacheStatistics"),m.appendChild(D);const T=document.createElement("div");h.appendChild(T),T.appendChild(document.createTextNode("Color Blend Mode: "));const w=document.createElement("select");w.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),T.appendChild(w);const R=document.createElement("textarea");R.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),T.className="cesium-cesiumInspector-styleEditor",T.appendChild(R);const V=makeButton("compileStyle","Compile (Ctrl+Enter)");T.appendChild(V);const x=document.createElement("div");x.className="cesium-cesiumInspector-error",x.setAttribute("data-bind","text: editorError"),T.appendChild(x),u.appendChild(c("Show Picked Only","showOnlyPickedTileDebugLabel")),u.appendChild(c("Geometric Error","showGeometricError")),u.appendChild(c("Rendering Statistics","showRenderingStatistics")),u.appendChild(c("Memory Usage (MB)","showMemoryUsage")),u.appendChild(c("Url","showUrl")),C.appendChild(c("Skip Tile LODs","skipLevelOfDetail"));const L=document.createElement("div");L.appendChild(makeRangeInput("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor")),C.appendChild(L);const A=document.createElement("div");A.appendChild(makeRangeInput("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD")),C.appendChild(A);const M=document.createElement("div");M.appendChild(makeRangeInput("skipLevels",0,10,1,"Min. levels to skip")),C.appendChild(M),C.appendChild(c("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),C.appendChild(c("Load siblings of visible tiles","loadSiblings")),knockout.applyBindings(s,i)}function makeRangeInput(e,t,i,n,s,a){a=defaultValue(a,e);const o=document.createElement("input");o.setAttribute("data-bind",`value: ${a}`),o.type="number";const d=document.createElement("input");d.type="range",d.min=t,d.max=i,d.step=n,d.setAttribute("data-bind",`valueUpdate: "input", value: ${e}`);const c=document.createElement("div");c.appendChild(d);const r=document.createElement("div");return r.className="cesium-cesiumInspector-slider",r.appendChild(document.createTextNode(s)),r.appendChild(o),r.appendChild(c),r}function makeButton(e,t,i){const n=document.createElement("button");n.type="button",n.textContent=t,n.className="cesium-cesiumInspector-pickButton";let s=`click: ${e}`;return defined(i)&&(s+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${i}}`),n.setAttribute("data-bind",s),n}Object.defineProperties(Cesium3DTilesInspector.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),Cesium3DTilesInspector.prototype.isDestroyed=function(){return!1},Cesium3DTilesInspector.prototype.destroy=function(){return knockout.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),destroyObject(this)};export default Cesium3DTilesInspector;